Improve code quality of `extractor.py` and `test_featurizer.py`

Remove code duplication from `test_featurizer` and reduce cognitive complexity from `extractor.py`